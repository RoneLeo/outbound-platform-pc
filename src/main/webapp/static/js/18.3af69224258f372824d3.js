webpackJsonp([18],{"9gqF":function(e,t){},QGY9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={name:"basetable",data:()=>({modelTitle:"添加文件",tableData:[],modelVisible:!1,addForm:{},file:{},size:10,page:1,totalElements:0,loading:!1,addLoading:!1,equipmentType:[],sblx:null}),mounted(){this.$axios.post("/equipmentType/findAllByGsid").then(e=>{let t=e.data;this.equipmentType=t,this.$route.params.sblx?this.sblx=this.$route.params.sblx:this.sblx=this.equipmentType&&this.equipmentType.length?this.equipmentType[0].id:"",this.getData()})},created(){},computed:{},methods:{getSblxData(){this.page=1,this.getData()},formatterSBLX(e){return this.$common.dictParse(e.sblx,this.equipmentType)},delFile(e,t){this.$confirm("是否确认删除该产品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post("/equipment/delete",this.$qs.stringify({id:t.id})).then(e=>{this.$message.success("已删除！"),this.getData()})}).catch(()=>{})},formatterWjlx(e){return this.$common.dictParse(e.wjlx,this.$dict.fileType)},look(e,t){this.$router.push({name:"addProduct",params:{pId:t.id}})},modelClose(e){this.$refs[e].resetFields()},getFile(e){this.file=e.target.files[0],this.addForm.file=this.file},handleCurrentChange(e){this.page=e,this.getData()},getData(){this.loading=!0,this.$axios.post("/equipment/findAllByGsidAndSblx",this.$qs.stringify({sblx:this.sblx,page:this.page,size:this.size})).then(e=>{this.loading=!1,this.tableData=e.data,this.totalElements=e.totalElements})},add(){this.$router.push("/addProduct")},saveEdit(e){this.$refs.addForm.validate(e=>{if(e){this.addLoading=!0;let e=new FormData;for(let t in this.addForm)e.append(t,this.addForm[t]);for(var t of e.values())console.log(t);let a={headers:{"Content-Type":"multipart/form-data"}};this.$axios.post("/file/add",e,a).then(e=>{this.addLoading=!1,this.modelVisible=!1,this.getData()})}})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 产品管理")])],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container"},[a("el-row",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"产品类型"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getSblxData},model:{value:e.sblx,callback:function(t){e.sblx=t},expression:"sblx"}},e._l(e.equipmentType,function(e){return a("el-option",{key:1.9098*e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"cpmc",label:"产品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sblx",label:"产品类型",formatter:e.formatterSBLX}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-lx-attention"},on:{click:function(a){return e.look(t.$index,t.row)}}},[e._v("点击查看\n                    ")]),e._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.delFile(t.$index,t.row)}}},[e._v("删除\n                    ")])]}}])})],1),e._v(" "),a("div",{staticStyle:{padding:"28px 8px"}},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:e.add}},[e._v("新增产品")]),e._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"prev, pager, next",total:e.totalElements},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.modelTitle,visible:e.modelVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.modelVisible=t},closed:function(t){return e.modelClose(e.addForm)}}},[a("el-form",{ref:e.addForm,attrs:{model:e.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文件名称",prop:"wjmc",rules:[{required:!0,message:"文件名称不能为空",trigger:"blur"}]}},[a("el-input",{model:{value:e.addForm.wjmc,callback:function(t){e.$set(e.addForm,"wjmc",t)},expression:"addForm.wjmc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件类型",prop:"wjlx",rules:[{required:!0,message:"文件类型不能为空",trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:"请选择文件类型"},model:{value:e.addForm.wjlx,callback:function(t){e.$set(e.addForm,"wjlx",t)},expression:"addForm.wjlx"}},e._l(this.$dict.fileType,function(e){return a("el-option",{key:e.id+Math.random(),attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文件",prop:"file",rules:[{required:!0,message:"文件不能为空",trigger:"blur"}]}},[a("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(t){return e.getFile(t)}}})])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modelVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:function(t){return e.saveEdit(e.addForm)}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=a("C7Lr")(l,i,!1,function(e){a("9gqF")},"data-v-4e96ba0d",null);t.default=s.exports}});