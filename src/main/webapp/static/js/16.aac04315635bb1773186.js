webpackJsonp([16],{bA75:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:()=>({fieldDialogTitle:"添加模板信息",checked:!0,baseType:[],fieldCases:[],dictType:"",batchData:[],addFormVisible:!1,dataForm:{},currentPage:1,pageSize:5,total:0,zdidArr:[],zdidAddArr:[],lxrNum:1,bzNum:1}),created(){this.getBaseType(),this.getField(),this.getBatchData()},methods:{getBaseType(){this.$axios.get("/baseType/findAll").then(e=>{if(200==e.resCode){let t=e.data;t&&t.length&&(this.baseType=[],this.zdidArr=[],t.forEach(e=>{this.zdidArr.push([]),this.zdidAddArr.push([]),this.baseType.push(e.name)}))}})},getField(){this.$axios.get("/fieldCaseBase/findAll").then(e=>{if(200==e.resCode){let t=e.data;this.fieldCases=t}})},getBatchData(){this.$axios.post("batch/findAll",{page:this.currentPage,pagesize:this.pageSize}).then(e=>{this.batchData=e.data,this.total=e.counts})},handleExport(e,t){let i=this.$baseURL+"/batch/exportExcel?pcid="+t.pcid;window.open(i)},JsFormatter(e){return this.$common.dictParse(e.js,this.roles)},handleAdd:function(){this.addFormVisible=!0,this.dataForm={},this.lxrNum=1,this.bzNum=1,this.zdidArr=this.zdidAddArr,this.fieldDialogTitle="添加模板信息"},handleEdit:function(e,t){this.dataForm=Object.assign({},t),this.fieldDialogTitle=t.pcmc+" 编辑";let i=this.$loading({text:"正在获取模板字段信息,请稍后..."});this.zdidArr=this.zdidAddArr,this.$axios.post("batch/findAllZdzh",{pcid:t.pcid}).then(e=>{i.close();let t=e.data;for(let e=0;e<t.length;e++){let i=t[e].type,a=[];t[e].bhzd.split(",").forEach(e=>{a.push(Number(e))}),this.zdidArr[i]=a,7==i?this.lxrNum=t[e].sl:9==i&&(this.bzNum=t[e].sl)}this.addFormVisible=!0})},dialogClose(){},saveData(){this.$refs.dataForm.validate(e=>{if(!e)return!1;{console.log(this.zdidArr);let e=[],t=this.lxrNum,i=this.bzNum;this.zdidArr.forEach((a,s)=>{if(7==s)for(let i=0;i<t;i++)a.forEach(t=>{e.push(t)});else if(9==s)for(let t=0;t<i;t++)a.forEach(t=>{e.push(t)});else a.forEach(t=>{e.push(t)})});let a="batch/add",s={pcmc:this.dataForm.pcmc,zdids:e.join(",")};this.dataForm.id&&(a="batch/update",s.pcid=this.dataForm.pcid),this.$axios.post(a,s).then(e=>{this.addFormVisible=!1,this.getBatchData(),this.$message.success("保存成功!")})}})},handleDel:function(e,t){this.$confirm("此操作将永久删除该批次模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.post("/batch/delete",{pcid:t.pcid}).then(e=>{200==e.resCode&&(this.getBatchData(),this.$message({type:"success",message:"删除成功!"}))})}).catch(()=>{})},handleSizeChange(e){this.pageSize=e,this.getBatchData()},handleCurrentChange(e){this.currentPage=e,this.getBatchData()}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"container"},[i("el-button",{attrs:{size:"mini",type:"success"},on:{click:e.handleAdd}},[e._v("新增批次")])],1),e._v(" "),i("div",{staticClass:"container"},[i("el-table",{attrs:{data:e.batchData}},[i("el-table-column",{attrs:{type:"index",width:"40",fixed:""}}),e._v(" "),i("el-table-column",{attrs:{prop:"pcmc",label:"批次名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"pcid",label:"批次ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"cjsj",label:"创建时间"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleExport(t.$index,t.row)}}},[e._v("导出")]),e._v(" "),i("el-button",{staticStyle:{color:"#ff0000"},attrs:{type:"text",size:"mini"},on:{click:function(i){return e.handleDel(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{"current-page":e.currentPage,background:"","page-sizes":[15,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{id:"fieldDialog",title:e.fieldDialogTitle,width:"60%",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t},closed:e.dialogClose}},[i("el-form",{ref:"dataForm",staticClass:"baseCaseForm",attrs:{model:e.dataForm,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"批次名称",prop:"pcmc",rules:[{required:!0,message:"输入不能为空",trigger:"blur"}]}},[i("el-input",{model:{value:e.dataForm.pcmc,callback:function(t){e.$set(e.dataForm,"pcmc",t)},expression:"dataForm.pcmc"}})],1),e._v(" "),e._l(e.baseType,function(t,a){return i("el-form-item",{key:a,attrs:{label:t}},[7==a?[i("el-checkbox-group",{model:{value:e.zdidArr[a],callback:function(t){e.$set(e.zdidArr,a,t)},expression:"zdidArr[index]"}},e._l(e.fieldCases[a],function(t){return i("el-checkbox",{key:t.id,attrs:{size:"mini",border:"",label:t.id}},[e._v(e._s(t.name))])}),1),e._v(" "),i("span",{},[e._v("\n                            联系人个数"),i("el-input-number",{staticStyle:{"margin-left":"10px"},attrs:{min:1,max:10,size:"mini"},model:{value:e.lxrNum,callback:function(t){e.lxrNum=t},expression:"lxrNum"}})],1)]:9==a?[i("el-checkbox-group",{model:{value:e.zdidArr[a],callback:function(t){e.$set(e.zdidArr,a,t)},expression:"zdidArr[index]"}},e._l(e.fieldCases[a],function(t){return i("el-checkbox",{key:t.id,attrs:{size:"mini",border:"",label:t.id}},[e._v(e._s(t.name))])}),1),e._v("\n                        备注个数"),i("el-input-number",{staticStyle:{"margin-left":"10px"},attrs:{min:1,max:10,size:"mini"},model:{value:e.bzNum,callback:function(t){e.bzNum=t},expression:"bzNum"}})]:[i("el-checkbox-group",{model:{value:e.zdidArr[a],callback:function(t){e.$set(e.zdidArr,a,t)},expression:"zdidArr[index]"}},e._l(e.fieldCases[a],function(t){return i("el-checkbox",{key:t.id,attrs:{size:"mini",border:"",label:t.id}},[e._v(e._s(t.name))])}),1)]],2)})],2),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var r=i("C7Lr")(a,s,!1,function(e){i("xUY6")},"data-v-5be80d5a",null);t.default=r.exports},xUY6:function(e,t){}});