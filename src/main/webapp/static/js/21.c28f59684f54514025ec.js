webpackJsonp([21],{V1sA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={name:"UEditor",props:{id:{type:String},config:{type:Object}},data:()=>({editor:null}),mounted(){this.editor=UE.delEditor("editor"),this.editor=UE.getEditor("editor",this.config)},destoryed(){this.editor.destory()},methods:{getUEContent:function(){return this.editor.getContent()},getContentTxt:function(){return this.editor.getContentTxt()}}},o={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("script",{attrs:{id:"editor",type:"text/plain"}})])}]},s={name:"basetable",components:{UEditor:i("C7Lr")(n,o,!1,null,null,null).exports},data:()=>({config:{toolbars:[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","customstyle","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","imagenone","imageleft","imageright","imagecenter","|","simpleupload","emotion","scrawl","map","pagebreak","|","horizontal","date","time","spechars","snapscreen","wordimage","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","charts","|","print","preview","searchreplace","drafts","help"]],autoHeightEnabled:!1,autoFloatEnabled:!0,initialContent:"请输入内容",autoClearinitialContent:!0,initialFrameWidth:1200,initialFrameHeight:450,UEDITOR_HOME_URL:"../../../static/ueditor/"},form:{},contents:[],bt:"",content:{},equipmentType:[],pId:null,updating:null}),mounted(){this.$nextTick(()=>{this.editor=UE.getEditor("editor")}),this.$axios.post("/equipmentType/findAllByGsid").then(t=>{let e=t.data;this.equipmentType=e})},created(){console.log(this.$route.params.pId),this.pId=this.$route.params.pId,this.$route.params.pId&&this.$axios.post("/equipment/findById?id="+this.$route.params.pId).then(t=>{console.log(t);let e=t.data[0];this.form={id:e.id,gsid:e.gsid,cpmc:e.cpmc,cptp:e.cptp,sblx:e.sblx},this.contents=e.cpxq,console.log(this.form,this.contents)})},computed:{},methods:{deleteTP(){this.form.cptp="",this.file={}},deleteItem(t,e){this.contents.splice(e,1),console.log(this.contents)},getFile(t){this.file=t.target.files[0],this.form.file=this.file},editItem(t,e){this.updating=e,this.bt=t.bt,this.content.bt=t.bt,this.content.xxnr="",this.content.index=e,window.setTimeout(()=>{this.editor.setContent(this.contents[e].xxnr)},50)},finishItem(){if(this.content.index>=0){let t=this.content.index;this.contents[t].bt=this.bt,this.contents[t].xxnr=this.$refs.ueditor.getUEContent(),this.updating=null}else this.pId&&(this.content.id=null,this.content.cpid=null),this.content.bt=this.bt,this.content.xxnr=this.$refs.ueditor.getUEContent(),this.contents.push(this.content);window.setTimeout(()=>{this.content={},this.bt="",this.editor.setContent("")},300)},prelook(){this.$refs.form.validate(t=>{if(t){let t="/equipment/add";this.pId&&(t="/equipment/update");let e=new FormData;for(let t in this.form)e.append(t,this.form[t]);e.append("contents",JSON.stringify(this.contents));let i={headers:{"Content-Type":"multipart/form-data"}};this.$axios.post(t,e,i).then(t=>{this.$refs.form.resetFields(),this.$router.push({name:"products",params:{sblx:this.form.sblx}})})}})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[i("div",{staticClass:"container"},[i("div",[i("el-row",{staticStyle:{"border-bottom":"1px dashed #0095FF","margin-bottom":"10px",padding:"8px 0"}},[i("el-col",{staticStyle:{height:"100%"},attrs:{span:22}},[i("el-form",{ref:"form",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.form,"label-position":"right"}},[i("el-form-item",{attrs:{"label-width":"80px",label:"产品类型",prop:"sblx",rules:[{required:!0,message:"产品类型不能为空",trigger:"blur"}]}},[i("el-select",{attrs:{placeholder:"请选择产品类型"},model:{value:t.form.sblx,callback:function(e){t.$set(t.form,"sblx",e)},expression:"form.sblx"}},t._l(this.equipmentType,function(t){return i("el-option",{key:2.0987*t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{"label-width":"150px",label:"产品名称",prop:"cpmc",rules:[{required:!0,message:"产品名称不能为空",trigger:"blur"}]}},[i("el-input",{attrs:{placeholder:"产品名称",clearable:""},model:{value:t.form.cpmc,callback:function(e){t.$set(t.form,"cpmc",e)},expression:"form.cpmc"}})],1),t._v(" "),t.form.id&&t.form.cptp?i("el-form-item",{attrs:{"label-width":"150px",label:"产品图片"}},[i("img",{staticStyle:{width:"140px",height:"100px",position:"relative","border-radius":"5px"},attrs:{src:"http://47.96.85.104:80"+t.form.cptp,alt:""}}),t._v(" "),t.form.cptp?i("i",{staticClass:"el-icon-error image-icon",on:{click:t.deleteTP}}):t._e()]):i("el-form-item",{attrs:{"label-width":"150px",label:"产品图片"}},[i("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(e){return t.getFile(e)}}})])],1)],1),t._v(" "),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:2}},[i("el-button",{attrs:{icon:"el-icon-success",type:"primary"},on:{click:t.prelook}},[t._v("保存")])],1)],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},t._l(t.contents,function(e,n){return i("div",{key:1.00107*n,staticClass:"contents",style:{borderBottom:n==t.contents.length-1?"1px dashed #dcdfe6":"0",marginBottom:n==t.contents.length-1?"30px":"20px"}},[i("el-row",{staticStyle:{"margin-bottom":"5px"}},[i("el-col",{attrs:{span:18}},[i("h3",{staticStyle:{padding:"0 10px",color:"#0095FF"}},[t._v(t._s(e.bt))])]),t._v(" "),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[i("el-button",{attrs:{type:"warning",icon:"el-icon-delete",disabled:t.updating===n},on:{click:function(i){return t.deleteItem(e,n)}}},[t._v("删除")]),t._v(" "),i("el-button",{attrs:{icon:"el-icon-edit",type:"primary",disabled:t.updating===n},on:{click:function(i){return t.editItem(e,n)}}},[t._v("编辑")])],1)],1),t._v(" "),i("div",{staticStyle:{padding:"3px 10px"},domProps:{innerHTML:t._s(e.xxnr)}})],1)}),0),t._v(" "),i("div",{staticStyle:{"margin-top":"30px"}},[i("el-row",[i("el-col",{attrs:{span:18}},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,"label-position":"right"}},[i("el-form-item",{attrs:{"label-width":"70px",label:"小标题"}},[i("el-input",{attrs:{placeholder:"请输入介绍标题",clearable:""},model:{value:t.bt,callback:function(e){t.bt=e},expression:"bt"}})],1)],1)],1),t._v(" "),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[i("el-button",{attrs:{type:"primary"},on:{click:t.finishItem}},[t._v("完成")])],1)],1),t._v(" "),i("UEditor",{ref:"ueditor",attrs:{config:t.config}})],1)])])},staticRenderFns:[]};var l=i("C7Lr")(s,r,!1,function(t){i("rL76")},"data-v-2ee8b92e",null);e.default=l.exports},rL76:function(t,e){}});